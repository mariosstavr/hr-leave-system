{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=\"http://0.0.0.0:7020\";// matches App.jsx\nexport default function AddEmployee(_ref){let{loadData}=_ref;const[year,setYear]=useState(new Date().getFullYear());const[employees,setEmployees]=useState([]);const[loading,setLoading]=useState(false);// Fetch employees directly from backend\nconst fetchEmployees=async()=>{setLoading(true);try{const res=await fetch(\"\".concat(API_URL,\"/api/employees?year=\").concat(year));const data=await res.json();setEmployees(data||[]);}catch(err){console.error(\"Error loading employees:\",err);setEmployees([]);}setLoading(false);};useEffect(()=>{fetchEmployees();},[year]);// Add new employee\nconst handleSubmit=async e=>{e.preventDefault();const form=e.target;const name=form.name.value.trim();const quota=form.quota.value?Number(form.quota.value):null;if(!name)return alert(\"Συμπλήρωσε όλα τα απαιτούμενα πεδία!\");try{await fetch(\"\".concat(API_URL,\"/api/add-employee\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({id:Date.now().toString(),name,year,days:quota})});form.reset();if(loadData)loadData();// refresh parent data\nawait fetchEmployees();// refresh this page’s list\nalert(\"Ο εργαζόμενος προστέθηκε!\");}catch(err){console.error(\"Add employee error:\",err);alert(\"Σφάλμα κατά την προσθήκη του εργαζόμενου!\");}};// Delete employee\nconst handleDelete=async(id,name)=>{if(!window.confirm(\"\\u0395\\u03AF\\u03C3\\u03C4\\u03B5 \\u03C3\\u03AF\\u03B3\\u03BF\\u03C5\\u03C1\\u03BF\\u03C2 \\u03CC\\u03C4\\u03B9 \\u03B8\\u03AD\\u03BB\\u03B5\\u03C4\\u03B5 \\u03BD\\u03B1 \\u03B4\\u03B9\\u03B1\\u03B3\\u03C1\\u03AC\\u03C8\\u03B5\\u03C4\\u03B5 \\u03C4\\u03BF\\u03BD \\u03B5\\u03C1\\u03B3\\u03B1\\u03B6\\u03CC\\u03BC\\u03B5\\u03BD\\u03BF \\\"\".concat(name,\"\\\" ;\")))return;try{await fetch(\"\".concat(API_URL,\"/api/delete-employee/\").concat(id),{method:\"DELETE\"});await fetchEmployees();if(loadData)loadData();}catch(err){console.error(\"Delete employee error:\",err);alert(\"Σφάλμα κατά τη διαγραφή του εργαζόμενου!\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"\\u03A0\\u03C1\\u03BF\\u03C3\\u03B8\\u03AE\\u03BA\\u03B7 \\u039D\\u03AD\\u03BF\\u03C5 \\u0395\\u03C1\\u03B3\\u03B1\\u03B6\\u03CC\\u03BC\\u03B5\\u03BD\\u03BF\\u03C5\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"flex flex-col gap-3 max-w-md mb-6\",children:[/*#__PURE__*/_jsx(\"input\",{name:\"name\",placeholder:\"\\u038C\\u03BD\\u03BF\\u03BC\\u03B1 \\u03B5\\u03C1\\u03B3\\u03B1\\u03B6\\u03CC\\u03BC\\u03B5\\u03BD\\u03BF\\u03C5\",required:true,className:\"border p-2 rounded\"}),/*#__PURE__*/_jsx(\"input\",{name:\"quota\",type:\"number\",placeholder:\"\\u03A3\\u03CD\\u03BD\\u03BF\\u03BB\\u03BF \\u03B4\\u03B9\\u03BA\\u03B1\\u03B9\\u03BF\\u03CD\\u03BC\\u03B5\\u03BD\\u03C9\\u03BD \\u03B7\\u03BC\\u03B5\\u03C1\\u03CE\\u03BD (\\u03C0\\u03C1\\u03BF\\u03B1\\u03B9\\u03C1\\u03B5\\u03C4\\u03B9\\u03BA\\u03CC)\",className:\"border p-2 rounded\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:year,onChange:e=>setYear(Number(e.target.value)),className:\"border p-2 rounded\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\",children:\"\\u03A0\\u03C1\\u03BF\\u03C3\\u03B8\\u03AE\\u03BA\\u03B7\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-2\",children:\"\\u039B\\u03AF\\u03C3\\u03C4\\u03B1 \\u0395\\u03C1\\u03B3\\u03B1\\u03B6\\u03BF\\u03BC\\u03AD\\u03BD\\u03C9\\u03BD\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"\\u03A6\\u03CC\\u03C1\\u03C4\\u03C9\\u03C3\\u03B7...\"}):employees.length===0?/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0394\\u03B5\\u03BD \\u03C5\\u03C0\\u03AC\\u03C1\\u03C7\\u03BF\\u03C5\\u03BD \\u03B5\\u03C1\\u03B3\\u03B1\\u03B6\\u03CC\\u03BC\\u03B5\\u03BD\\u03BF\\u03B9 \\u03B3\\u03B9\\u03B1 \\u03C4\\u03BF \\u03AD\\u03C4\\u03BF\\u03C2 \",year,\".\"]}):/*#__PURE__*/_jsxs(\"table\",{className:\"table-auto border-collapse border w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"border p-2\",children:\"\\u038C\\u03BD\\u03BF\\u03BC\\u03B1\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border p-2\",children:\"\\u0394\\u03B9\\u03BA\\u03B1\\u03B9\\u03BF\\u03CD\\u03BC\\u03B5\\u03BD\\u03B5\\u03C2 \\u0397\\u03BC\\u03AD\\u03C1\\u03B5\\u03C2\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border p-2\",children:\"\\u0395\\u03BD\\u03AD\\u03C1\\u03B3\\u03B5\\u03B9\\u03B5\\u03C2\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:employees.map(emp=>{var _emp$quotas;const quotaObj=(_emp$quotas=emp.quotas)===null||_emp$quotas===void 0?void 0:_emp$quotas.find(q=>q.year===year);const quota=quotaObj?quotaObj.days:\"-\";return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"border p-2\",children:emp.name}),/*#__PURE__*/_jsx(\"td\",{className:\"border p-2\",children:quota}),/*#__PURE__*/_jsx(\"td\",{className:\"border p-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(emp.id,emp.name),className:\"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600\",children:\"\\u0394\\u03B9\\u03B1\\u03B3\\u03C1\\u03B1\\u03C6\\u03AE\"})})]},emp.id);})})]})]});}","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","API_URL","AddEmployee","_ref","loadData","year","setYear","Date","getFullYear","employees","setEmployees","loading","setLoading","fetchEmployees","res","fetch","concat","data","json","err","console","error","handleSubmit","e","preventDefault","form","target","name","value","trim","quota","Number","alert","method","headers","body","JSON","stringify","id","now","toString","days","reset","handleDelete","window","confirm","className","children","onSubmit","placeholder","required","type","onChange","length","map","emp","_emp$quotas","quotaObj","quotas","find","q","onClick"],"sources":["D:/projects/ΑΔΕΙΕΣ/server/client/src/AddEmployee.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\nconst API_URL = \"http://0.0.0.0:7020\"; // matches App.jsx\r\n\r\nexport default function AddEmployee({ loadData }) {\r\n  const [year, setYear] = useState(new Date().getFullYear());\r\n  const [employees, setEmployees] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Fetch employees directly from backend\r\n  const fetchEmployees = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(`${API_URL}/api/employees?year=${year}`);\r\n      const data = await res.json();\r\n      setEmployees(data || []);\r\n    } catch (err) {\r\n      console.error(\"Error loading employees:\", err);\r\n      setEmployees([]);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchEmployees();\r\n  }, [year]);\r\n\r\n  // Add new employee\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const form = e.target;\r\n    const name = form.name.value.trim();\r\n    const quota = form.quota.value ? Number(form.quota.value) : null;\r\n\r\n    if (!name) return alert(\"Συμπλήρωσε όλα τα απαιτούμενα πεδία!\");\r\n\r\n    try {\r\n      await fetch(`${API_URL}/api/add-employee`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          id: Date.now().toString(),\r\n          name,\r\n          year,\r\n          days: quota,\r\n        }),\r\n      });\r\n      form.reset();\r\n      if (loadData) loadData(); // refresh parent data\r\n      await fetchEmployees(); // refresh this page’s list\r\n      alert(\"Ο εργαζόμενος προστέθηκε!\");\r\n    } catch (err) {\r\n      console.error(\"Add employee error:\", err);\r\n      alert(\"Σφάλμα κατά την προσθήκη του εργαζόμενου!\");\r\n    }\r\n  };\r\n\r\n  // Delete employee\r\n  const handleDelete = async (id, name) => {\r\n    if (!window.confirm(`Είστε σίγουρος ότι θέλετε να διαγράψετε τον εργαζόμενο \"${name}\" ;`)) return;\r\n\r\n    try {\r\n      await fetch(`${API_URL}/api/delete-employee/${id}`, { method: \"DELETE\" });\r\n      await fetchEmployees();\r\n      if (loadData) loadData();\r\n    } catch (err) {\r\n      console.error(\"Delete employee error:\", err);\r\n      alert(\"Σφάλμα κατά τη διαγραφή του εργαζόμενου!\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-4\">\r\n      <h2 className=\"text-xl font-bold mb-4\">Προσθήκη Νέου Εργαζόμενου</h2>\r\n\r\n      <form onSubmit={handleSubmit} className=\"flex flex-col gap-3 max-w-md mb-6\">\r\n        <input\r\n          name=\"name\"\r\n          placeholder=\"Όνομα εργαζόμενου\"\r\n          required\r\n          className=\"border p-2 rounded\"\r\n        />\r\n        <input\r\n          name=\"quota\"\r\n          type=\"number\"\r\n          placeholder=\"Σύνολο δικαιούμενων ημερών (προαιρετικό)\"\r\n          className=\"border p-2 rounded\"\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          value={year}\r\n          onChange={(e) => setYear(Number(e.target.value))}\r\n          className=\"border p-2 rounded\"\r\n        />\r\n        <button\r\n          type=\"submit\"\r\n          className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\r\n        >\r\n          Προσθήκη\r\n        </button>\r\n      </form>\r\n\r\n      <h3 className=\"text-lg font-bold mb-2\">Λίστα Εργαζομένων</h3>\r\n      {loading ? (\r\n        <p>Φόρτωση...</p>\r\n      ) : employees.length === 0 ? (\r\n        <p>Δεν υπάρχουν εργαζόμενοι για το έτος {year}.</p>\r\n      ) : (\r\n        <table className=\"table-auto border-collapse border w-full\">\r\n          <thead>\r\n            <tr>\r\n              <th className=\"border p-2\">Όνομα</th>\r\n              <th className=\"border p-2\">Δικαιούμενες Ημέρες</th>\r\n              <th className=\"border p-2\">Ενέργειες</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {employees.map((emp) => {\r\n              const quotaObj = emp.quotas?.find((q) => q.year === year);\r\n              const quota = quotaObj ? quotaObj.days : \"-\";\r\n              return (\r\n                <tr key={emp.id}>\r\n                  <td className=\"border p-2\">{emp.name}</td>\r\n                  <td className=\"border p-2\">{quota}</td>\r\n                  <td className=\"border p-2\">\r\n                    <button\r\n                      onClick={() => handleDelete(emp.id, emp.name)}\r\n                      className=\"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600\"\r\n                    >\r\n                      Διαγραφή\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
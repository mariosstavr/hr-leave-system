{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function EditEmployee(_ref){let{loadData}=_ref;const[employees,setEmployees]=useState([]);const[selectedId,setSelectedId]=useState(\"\");const[name,setName]=useState(\"\");const[quota,setQuota]=useState(\"\");const[year,setYear]=useState(new Date().getFullYear());// ------------------- Load Employees -------------------\nconst loadEmployees=async()=>{try{const res=await fetch(\"/api/employees\");const data=await res.json();setEmployees(data||[]);}catch(err){console.error(\"Error loading employees:\",err);}};useEffect(()=>{loadEmployees();},[]);// ------------------- Select Employee -------------------\nconst handleSelect=e=>{const empId=e.target.value;setSelectedId(empId);const emp=employees.find(x=>x.id===empId);if(emp){var _emp$quotas;setName(emp.name);// Get quota for selected year\nconst quotaObj=(_emp$quotas=emp.quotas)===null||_emp$quotas===void 0?void 0:_emp$quotas.find(q=>q.year===year);setQuota(quotaObj?quotaObj.days:\"\");}else{setName(\"\");setQuota(\"\");}};// ------------------- Update Employee -------------------\nconst handleSubmit=async e=>{e.preventDefault();if(!selectedId)return alert(\"Επέλεξε εργαζόμενο!\");try{await fetch(\"/api/update-employee\",{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({id:selectedId,name,year,days:quota?Number(quota):null})});alert(\"Ο εργαζόμενος ενημερώθηκε!\");loadEmployees();loadData();}catch(err){console.error(\"Error updating employee:\",err);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 max-w-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"\\u0395\\u03C0\\u03B5\\u03BE\\u03B5\\u03C1\\u03B3\\u03B1\\u03C3\\u03AF\\u03B1 \\u0395\\u03C1\\u03B3\\u03B1\\u03B6\\u03BF\\u03BC\\u03AD\\u03BD\\u03BF\\u03C5\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"flex flex-col gap-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedId,onChange:handleSelect,className:\"border p-2 rounded\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- \\u0395\\u03C0\\u03AD\\u03BB\\u03B5\\u03BE\\u03B5 \\u03C5\\u03C0\\u03AC\\u03BB\\u03BB\\u03B7\\u03BB\\u03BF --\"}),employees.map(e=>/*#__PURE__*/_jsx(\"option\",{value:e.id,children:e.name},e.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u038C\\u03BD\\u03BF\\u03BC\\u03B1 \\u03B5\\u03C1\\u03B3\\u03B1\\u03B6\\u03CC\\u03BC\\u03B5\\u03BD\\u03BF\\u03C5\",value:name,onChange:e=>setName(e.target.value),required:true,className:\"border p-2 rounded\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\u03A3\\u03CD\\u03BD\\u03BF\\u03BB\\u03BF \\u03B4\\u03B9\\u03BA\\u03B1\\u03B9\\u03BF\\u03CD\\u03BC\\u03B5\\u03BD\\u03C9\\u03BD \\u03B7\\u03BC\\u03B5\\u03C1\\u03CE\\u03BD\",value:quota,onChange:e=>setQuota(e.target.value),className:\"border p-2 rounded\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:year,onChange:e=>{var _emp$quotas2;const newYear=Number(e.target.value);setYear(newYear);const emp=employees.find(x=>x.id===selectedId);const quotaObj=emp===null||emp===void 0?void 0:(_emp$quotas2=emp.quotas)===null||_emp$quotas2===void 0?void 0:_emp$quotas2.find(q=>q.year===newYear);setQuota(quotaObj?quotaObj.days:\"\");},className:\"border p-2 rounded\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-700\",children:[\"\\u03A3\\u03CD\\u03BD\\u03BF\\u03BB\\u03BF \\u03B7\\u03BC\\u03B5\\u03C1\\u03CE\\u03BD \\u03B3\\u03B9\\u03B1 \\u03C4\\u03BF \",year,\": \",/*#__PURE__*/_jsx(\"strong\",{children:quota||0})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600\",children:\"\\u0395\\u03BD\\u03B7\\u03BC\\u03AD\\u03C1\\u03C9\\u03C3\\u03B7 \\u0395\\u03C1\\u03B3\\u03B1\\u03B6\\u03CC\\u03BC\\u03B5\\u03BD\\u03BF\\u03C5\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","EditEmployee","_ref","loadData","employees","setEmployees","selectedId","setSelectedId","name","setName","quota","setQuota","year","setYear","Date","getFullYear","loadEmployees","res","fetch","data","json","err","console","error","handleSelect","e","empId","target","value","emp","find","x","id","_emp$quotas","quotaObj","quotas","q","days","handleSubmit","preventDefault","alert","method","headers","body","JSON","stringify","Number","className","children","onSubmit","onChange","required","map","type","placeholder","_emp$quotas2","newYear"],"sources":["D:/projects/ΑΔΕΙΕΣ/server/client/src/EditEmployee.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n\r\nexport default function EditEmployee({ loadData }) {\r\n  const [employees, setEmployees] = useState([]);\r\n  const [selectedId, setSelectedId] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [quota, setQuota] = useState(\"\");\r\n  const [year, setYear] = useState(new Date().getFullYear());\r\n\r\n  // ------------------- Load Employees -------------------\r\n  const loadEmployees = async () => {\r\n    try {\r\n      const res = await fetch(`/api/employees`);\r\n      const data = await res.json();\r\n      setEmployees(data || []);\r\n    } catch (err) {\r\n      console.error(\"Error loading employees:\", err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadEmployees();\r\n  }, []);\r\n\r\n  // ------------------- Select Employee -------------------\r\n  const handleSelect = (e) => {\r\n    const empId = e.target.value;\r\n    setSelectedId(empId);\r\n\r\n    const emp = employees.find((x) => x.id === empId);\r\n    if (emp) {\r\n      setName(emp.name);\r\n\r\n      // Get quota for selected year\r\n      const quotaObj = emp.quotas?.find((q) => q.year === year);\r\n      setQuota(quotaObj ? quotaObj.days : \"\");\r\n    } else {\r\n      setName(\"\");\r\n      setQuota(\"\");\r\n    }\r\n  };\r\n\r\n  // ------------------- Update Employee -------------------\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!selectedId) return alert(\"Επέλεξε εργαζόμενο!\");\r\n\r\n    try {\r\n      await fetch(`/api/update-employee`, {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          id: selectedId,\r\n          name,\r\n          year,\r\n          days: quota ? Number(quota) : null,\r\n        }),\r\n      });\r\n      alert(\"Ο εργαζόμενος ενημερώθηκε!\");\r\n      loadEmployees();\r\n      loadData();\r\n    } catch (err) {\r\n      console.error(\"Error updating employee:\", err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4 max-w-md\">\r\n      <h2 className=\"text-xl font-bold mb-4\">Επεξεργασία Εργαζομένου</h2>\r\n      <form onSubmit={handleSubmit} className=\"flex flex-col gap-3\">\r\n        <select\r\n          value={selectedId}\r\n          onChange={handleSelect}\r\n          className=\"border p-2 rounded\"\r\n          required\r\n        >\r\n          <option value=\"\">-- Επέλεξε υπάλληλο --</option>\r\n          {employees.map((e) => (\r\n            <option key={e.id} value={e.id}>\r\n              {e.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Όνομα εργαζόμενου\"\r\n          value={name}\r\n          onChange={(e) => setName(e.target.value)}\r\n          required\r\n          className=\"border p-2 rounded\"\r\n        />\r\n\r\n        <input\r\n          type=\"number\"\r\n          placeholder=\"Σύνολο δικαιούμενων ημερών\"\r\n          value={quota}\r\n          onChange={(e) => setQuota(e.target.value)}\r\n          className=\"border p-2 rounded\"\r\n        />\r\n\r\n        <input\r\n          type=\"number\"\r\n          value={year}\r\n          onChange={(e) => {\r\n            const newYear = Number(e.target.value);\r\n            setYear(newYear);\r\n\r\n            const emp = employees.find((x) => x.id === selectedId);\r\n            const quotaObj = emp?.quotas?.find((q) => q.year === newYear);\r\n            setQuota(quotaObj ? quotaObj.days : \"\");\r\n          }}\r\n          className=\"border p-2 rounded\"\r\n        />\r\n\r\n        <div className=\"text-gray-700\">\r\n          Σύνολο ημερών για το {year}: <strong>{quota || 0}</strong>\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600\"\r\n        >\r\n          Ενημέρωση Εργαζόμενου\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnD,cAAe,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC/C,KAAM,CAACE,SAAS,CAAEC,YAAY,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACU,UAAU,CAAEC,aAAa,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACY,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACc,KAAK,CAAEC,QAAQ,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACgB,IAAI,CAAEC,OAAO,CAAC,CAAGjB,QAAQ,CAAC,GAAI,CAAAkB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAAC,CAE1D;AACA,KAAM,CAAAC,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAC,KAAK,iBAAiB,CAAC,CACzC,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAF,GAAG,CAACG,IAAI,CAAC,CAAC,CAC7Bf,YAAY,CAACc,IAAI,EAAI,EAAE,CAAC,CAC1B,CAAE,MAAOE,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,0BAA0B,CAAEF,GAAG,CAAC,CAChD,CACF,CAAC,CAED1B,SAAS,CAAC,IAAM,CACdqB,aAAa,CAAC,CAAC,CACjB,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAQ,YAAY,CAAIC,CAAC,EAAK,CAC1B,KAAM,CAAAC,KAAK,CAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAC5BrB,aAAa,CAACmB,KAAK,CAAC,CAEpB,KAAM,CAAAG,GAAG,CAAGzB,SAAS,CAAC0B,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACC,EAAE,GAAKN,KAAK,CAAC,CACjD,GAAIG,GAAG,CAAE,KAAAI,WAAA,CACPxB,OAAO,CAACoB,GAAG,CAACrB,IAAI,CAAC,CAEjB;AACA,KAAM,CAAA0B,QAAQ,EAAAD,WAAA,CAAGJ,GAAG,CAACM,MAAM,UAAAF,WAAA,iBAAVA,WAAA,CAAYH,IAAI,CAAEM,CAAC,EAAKA,CAAC,CAACxB,IAAI,GAAKA,IAAI,CAAC,CACzDD,QAAQ,CAACuB,QAAQ,CAAGA,QAAQ,CAACG,IAAI,CAAG,EAAE,CAAC,CACzC,CAAC,IAAM,CACL5B,OAAO,CAAC,EAAE,CAAC,CACXE,QAAQ,CAAC,EAAE,CAAC,CACd,CACF,CAAC,CAED;AACA,KAAM,CAAA2B,YAAY,CAAG,KAAO,CAAAb,CAAC,EAAK,CAChCA,CAAC,CAACc,cAAc,CAAC,CAAC,CAClB,GAAI,CAACjC,UAAU,CAAE,MAAO,CAAAkC,KAAK,CAAC,qBAAqB,CAAC,CAEpD,GAAI,CACF,KAAM,CAAAtB,KAAK,wBAAyB,CAClCuB,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAAC,CAC/CC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBb,EAAE,CAAE1B,UAAU,CACdE,IAAI,CACJI,IAAI,CACJyB,IAAI,CAAE3B,KAAK,CAAGoC,MAAM,CAACpC,KAAK,CAAC,CAAG,IAChC,CAAC,CACH,CAAC,CAAC,CACF8B,KAAK,CAAC,4BAA4B,CAAC,CACnCxB,aAAa,CAAC,CAAC,CACfb,QAAQ,CAAC,CAAC,CACZ,CAAE,MAAOkB,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,0BAA0B,CAAEF,GAAG,CAAC,CAChD,CACF,CAAC,CAED,mBACErB,KAAA,QAAK+C,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BlD,IAAA,OAAIiD,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAC,uIAAuB,CAAI,CAAC,cACnEhD,KAAA,SAAMiD,QAAQ,CAAEX,YAAa,CAACS,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAC3DhD,KAAA,WACE4B,KAAK,CAAEtB,UAAW,CAClB4C,QAAQ,CAAE1B,YAAa,CACvBuB,SAAS,CAAC,oBAAoB,CAC9BI,QAAQ,MAAAH,QAAA,eAERlD,IAAA,WAAQ8B,KAAK,CAAC,EAAE,CAAAoB,QAAA,CAAC,mGAAsB,CAAQ,CAAC,CAC/C5C,SAAS,CAACgD,GAAG,CAAE3B,CAAC,eACf3B,IAAA,WAAmB8B,KAAK,CAAEH,CAAC,CAACO,EAAG,CAAAgB,QAAA,CAC5BvB,CAAC,CAACjB,IAAI,EADIiB,CAAC,CAACO,EAEP,CACT,CAAC,EACI,CAAC,cAETlC,IAAA,UACEuD,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,mGAAmB,CAC/B1B,KAAK,CAAEpB,IAAK,CACZ0C,QAAQ,CAAGzB,CAAC,EAAKhB,OAAO,CAACgB,CAAC,CAACE,MAAM,CAACC,KAAK,CAAE,CACzCuB,QAAQ,MACRJ,SAAS,CAAC,oBAAoB,CAC/B,CAAC,cAEFjD,IAAA,UACEuD,IAAI,CAAC,QAAQ,CACbC,WAAW,CAAC,oJAA4B,CACxC1B,KAAK,CAAElB,KAAM,CACbwC,QAAQ,CAAGzB,CAAC,EAAKd,QAAQ,CAACc,CAAC,CAACE,MAAM,CAACC,KAAK,CAAE,CAC1CmB,SAAS,CAAC,oBAAoB,CAC/B,CAAC,cAEFjD,IAAA,UACEuD,IAAI,CAAC,QAAQ,CACbzB,KAAK,CAAEhB,IAAK,CACZsC,QAAQ,CAAGzB,CAAC,EAAK,KAAA8B,YAAA,CACf,KAAM,CAAAC,OAAO,CAAGV,MAAM,CAACrB,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CACtCf,OAAO,CAAC2C,OAAO,CAAC,CAEhB,KAAM,CAAA3B,GAAG,CAAGzB,SAAS,CAAC0B,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACC,EAAE,GAAK1B,UAAU,CAAC,CACtD,KAAM,CAAA4B,QAAQ,CAAGL,GAAG,SAAHA,GAAG,kBAAA0B,YAAA,CAAH1B,GAAG,CAAEM,MAAM,UAAAoB,YAAA,iBAAXA,YAAA,CAAazB,IAAI,CAAEM,CAAC,EAAKA,CAAC,CAACxB,IAAI,GAAK4C,OAAO,CAAC,CAC7D7C,QAAQ,CAACuB,QAAQ,CAAGA,QAAQ,CAACG,IAAI,CAAG,EAAE,CAAC,CACzC,CAAE,CACFU,SAAS,CAAC,oBAAoB,CAC/B,CAAC,cAEF/C,KAAA,QAAK+C,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAC,4GACR,CAACpC,IAAI,CAAC,IAAE,cAAAd,IAAA,WAAAkD,QAAA,CAAStC,KAAK,EAAI,CAAC,CAAS,CAAC,EACvD,CAAC,cAENZ,IAAA,WACEuD,IAAI,CAAC,QAAQ,CACbN,SAAS,CAAC,gEAAgE,CAAAC,QAAA,CAC3E,2HAED,CAAQ,CAAC,EACL,CAAC,EACJ,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}